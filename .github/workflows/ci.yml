name: CI\n\non:\n  push:\n    branches: [main, develop]\n  pull_request:\n    branches: [main, develop]\n\njobs:\n  lint:\n    name: Lint\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n\n      - name: Setup Node.js\n        uses: actions/setup-node@v4\n        with:\n          node-version: 18\n          cache: npm\n\n      - name: Install dependencies\n        run: npm ci\n\n      - name: Lint\n        run: npm run lint\n\n  typecheck:\n    name: Type Check\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n\n      - name: Setup Node.js\n        uses: actions/setup-node@v4\n        with:\n          node-version: 18\n          cache: npm\n\n      - name: Install dependencies\n        run: npm ci\n\n      - name: Type check\n        run: npm run typecheck\n\n  test:\n    name: Test\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n\n      - name: Setup Node.js\n        uses: actions/setup-node@v4\n        with:\n          node-version: 18\n          cache: npm\n\n      - name: Install dependencies\n        run: npm ci\n\n      - name: Run tests\n        run: npm run test\n        env:\n          CI: true\n\n  build:\n    name: Build\n    runs-on: ubuntu-latest\n    needs: [lint, typecheck, test]\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n\n      - name: Setup Node.js\n        uses: actions/setup-node@v4\n        with:\n          node-version: 18\n          cache: npm\n\n      - name: Install dependencies\n        run: npm ci\n\n      - name: Build\n        run: npm run build\n        env:\n          # Mock env vars for build\n          DATABASE_URL: postgresql://mock:mock@localhost:5432/mock\n          JWT_SECRET: mock-jwt-secret\n          JWT_REFRESH_SECRET: mock-refresh-secret\n          STRIPE_SECRET_KEY: sk_test_mock\n          STRIPE_PUBLISHABLE_KEY: pk_test_mock\n          SENDGRID_API_KEY: SG.mock\n          OPENAI_API_KEY: sk-mock\n          APP_BASE_URL: https://app.aisalesagent.com\n          ENCRYPTION_KEY: mock-encryption-key-32-chars-long\n